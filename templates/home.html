{{define "home.html"}}
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{.Title}}</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
{{template "header" .}}

<main class="container">

<section class="toolbar">
  <form method="GET" action="/" class="filters">

    <input type="text" name="q" placeholder="Nom ou ID" value="{{.Q}}" />

    <select name="type">
      <option value="">Énergie (toutes)</option>
      <option value="feu" {{if eq .Type "feu"}}selected{{end}}>Feu</option>
      <option value="eau" {{if eq .Type "eau"}}selected{{end}}>Eau</option>
      <option value="plante" {{if eq .Type "plante"}}selected{{end}}>Plante</option>
      <option value="foudre" {{if eq .Type "foudre"}}selected{{end}}>Foudre</option>
      <option value="psy" {{if eq .Type "psy"}}selected{{end}}>Psy</option>
      <option value="combat" {{if eq .Type "combat"}}selected{{end}}>Combat</option>
      <option value="obscurité" {{if eq .Type "obscurité"}}selected{{end}}>Obscurité</option>
      <option value="métal" {{if eq .Type "métal"}}selected{{end}}>Métal</option>
      <option value="dragon" {{if eq .Type "dragon"}}selected{{end}}>Dragon</option>
      <option value="incolore" {{if eq .Type "incolore"}}selected{{end}}>Incolore</option>
    </select>

    <select name="series">
      <option value="">Série (toutes)</option>
      {{range .Series}}
        <option value="{{.ID}}" {{if eq $.SeriesSelected .ID}}selected{{end}}>{{.Name}}</option>
      {{end}}
    </select>

    <button type="submit">Appliquer</button>

  </form>

  <div class="meta">{{.Total}} résultats</div>
</section>

<section class="grid">
  {{range .Cards}}
  <article class="card">
    <div class="card-top">
      <span class="pill">{{.ID}}</span>
      <form method="POST" action="/api/favorites/toggle">
        <input type="hidden" name="id" value="{{.ID}}">
        <input type="hidden" name="next" value="/?q={{$.Q}}&type={{$.Type}}&series={{$.SeriesSelected}}&page={{$.Page}}">
        <button type="submit" class="fav-btn {{if index $.Favs .ID}}is-fav{{end}}">★</button>
      </form>
    </div>

    <a class="card-link" href="/pokemon/details?id={{.ID}}">
      <div class="thumb">
        {{if .Image}}
          <img src="{{.Image}}/low.webp" alt="{{.Name}}">
        {{else}}
          <div class="thumb-empty">No image</div>
        {{end}}
      </div>
      <h3>{{.Name}}</h3>
    </a>
  </article>
  {{end}}
</section>

<section class="pagination">
  {{if gt .TotalPages 1}}
  <div class="pager">
    {{if gt .Page 1}}
      <a href="/?q={{.Q}}&type={{.Type}}&series={{.SeriesSelected}}&page={{sub .Page 1}}">←</a>
    {{end}}
    <span>Page {{.Page}} / {{.TotalPages}}</span>
    {{if lt .Page .TotalPages}}
      <a href="/?q={{.Q}}&type={{.Type}}&series={{.SeriesSelected}}&page={{add .Page 1}}">→</a>
    {{end}}
  </div>
  {{end}}
</section>

</main>

</body>
</html>
{{end}}
